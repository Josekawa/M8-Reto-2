---
title: "Presentaci√≥n ‚Äì Proyecto CRONOS2"
author: "Jose Carlos Gomez Fernandez"
date: "`r Sys.Date()`"
output:
  beamer_presentation: default
  ioslides_presentation: default
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(tidyverse)
library(knitr)
df <- readr::read_csv("../Datos/CRON2W4e01_depurado.csv",
                      show_col_types = FALSE)

# Normalizar nombres de columnas
names(df) <- tolower(names(df))
names(df) <- gsub("[^a-z0-9]+", "_", names(df))

# Reglas comunes del codebook
df <- df %>%
  mutate(
    gndr = case_when(gndr == 1 ~ "Hombre",
                     gndr == 2 ~ "Mujer",
                     TRUE ~ NA_character_),
    agea = ifelse(!is.na(agea), pmin(pmax(agea, 0), 100), NA_real_)
  )

# Calcular √≠ndice de confianza institucional
trust_cols <- intersect(names(df), paste0("w4q", 61:73))
df <- df %>%
  rowwise() %>%
  mutate(trust_index = if (sum(!is.na(c_across(all_of(trust_cols)))) > 0)
                         mean(c_across(all_of(trust_cols)), na.rm = TRUE)
                       else NA_real_) %>%
  ungroup()

```

## Introducci√≥n
Este proyecto utiliza datos de CRONOS-2 Wave 4, una encuesta internacional sobre actitudes sociales y pol√≠ticas. El objetivo es analizar la confianza en diferentes cuestiones sociales y explorar c√≥mo var√≠a seg√∫n factores sociodemogr√°ficos como edad, g√©nero y nivel socioecon√≥mico.

La presentaci√≥n ofrece una visi√≥n descriptiva de los indicadores principales y destaca patrones relevantes para comprender la relaci√≥n entre ciudadan√≠a y opini√≥n.

## Tabla resumen
```{r}
ggplot(data = df, aes(x = agea)) +
  geom_histogram(binwidth = 5, fill = "steelblue", color = "white") +
  labs(title = "Distribuci√≥n de la edad de la muestra",
       x = "Edad", y = "Frecuencia") +
  theme_minimal(base_size = 14)


ggplot(data = df %>% filter(!is.na(gndr)), aes(x = gndr)) +
  geom_bar(fill = "tomato") +
  labs(title = "Distribuci√≥n por g√©nero",
       x = "G√©nero", y = "N√∫mero de casos") +
  theme_minimal(base_size = 14)

# Seleccionar solo columnas de confianza
trust_cols <- intersect(names(df), paste0("w4q", 61:73))

# Seleccionar variables de confianza
trust_cols <- intersect(names(df), paste0("w4q", 61:73))

df %>%
  select(all_of(paste0("w4q", 61:73))) %>%
  pivot_longer(cols = everything(), names_to = "Institucion", values_to = "Confianza") %>%
  filter(!is.na(Confianza)) %>%
  group_by(Institucion) %>%
  summarise(Media_confianza = mean(Confianza, na.rm = TRUE)) %>%
  ggplot(aes(x = reorder(Institucion, Media_confianza),
             y = Media_confianza, fill = Institucion)) +
  geom_col(show.legend = FALSE) +
  coord_flip() +
  labs(title = "Confianza media en instituciones (w4q61‚Äìw4q73)",
       x = "Variable", y = "Media (1‚Äì5)") +
  theme_minimal(base_size = 14)




```


## Interpretaci√≥n
En nuestra muestra (6.032 casos):

La edad media es de 50,8 a√±os
(D.E. = 29,4).

La satisfacci√≥n con los ingresos presenta un promedio de 1,7 en una escala de 1 a 10.

El √≠ndice medio de confianza institucional es de 4,5 en una escala de 1 a 5.

üëâ Estos resultados muestran diferencias notables entre pa√≠ses, lo que subraya la importancia de considerar los factores sociodemogr√°ficos y econ√≥micos en el an√°lisis de la confianza en las instituciones.
